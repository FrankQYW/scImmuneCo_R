library(tidyverse)
module_info <- read.csv('../../06.for_website/gene_module_website.csv')
View(module_info)
usethis::use_data(mtcars_data, overwrite = TRUE)
usethis::use_data(module_info, overwrite = TRUE)
devtools::document()
library(scImmuneCo)
data(module_info)
a <-data(module_info)
a <-data(module_info)
library(scImmuneCo)
devtools::install()
.Last.error
devtools::install()
devtools::install()
devtools::install()
devtools::install()
sjs_object <- readRDS('F:/coexpression_project/01.cscore/SjS/rds/SjS.rds')
gsva_cell_type(sjs_object, cell = 'CD4T')
gsva_cell_type(sjs_object, cell = 'CD4 T')
library(scImmuneCo)
gsva_cell_type(sjs_object, cell = 'CD4 T')
library(Seurat)
gsva_cell_type(sjs_object, cell = 'CD4 T')
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
unloadNamespace('Seurat')
library(scImmuneCo)
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::install()
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
NormalizeData()
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::install()
devtools::document()
devtools::document()
devtools::install()
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
library(scImmuneCo)
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::document()
devtools::install()
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
library(scImmuneCo)
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::install()
devtools::document()
devtools::document()
devtools::install()
library(scImmuneCo)
library(Seurat)
unloadNamespace(Seurat)
unloadNamespace('Seurat')
unloadNamespace('scImmuneCo')
library(scImmuneCo)
sjs_object <- readRDS('F:/coexpression_project/01.cscore/SjS/rds/SjS.rds')
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
module_info
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::document()
devtools::install()
library(scImmuneCo)
gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::document()
devtools::install()
library(scImmuneCo)
sjs_object <- readRDS('F:/coexpression_project/01.cscore/SjS/rds/SjS.rds')
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
module_info
devtools::document()
devtools::install()
library(scImmuneCo)
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::document()
devtools::install()
library(scImmuneCo)
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
devtools::document()
devtools::install()
library(scImmuneCo)
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
A
View(a)
?merge
factor
?levels
levels
devtools::document()
devtools::install()
library(scImmuneCo)
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
unique(sjs_object@meta.data$condition)
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'Groups',
condition1 = 'SjS',
condition2 = 'HC')
rownames_to_column
?rownames_to_column
devtools::document()
devtools::install()
library(scImmuneCo)
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'Groups',
condition1 = 'SjS',
condition2 = 'HC')
devtools::document()
devtools::install()
library(scImmuneCo)
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'Groups',
condition1 = 'SjS',
condition2 = 'HC')
colnames(A)
colnames(a)
View(a)
merge
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
?model.matrix
lmFit
?lmFit
devtools::document()
devtools::install()
library(scImmuneCo)
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
View(b)
unique(sjs_object$predicted.celltype.l1)
?rbind
devtools::document()
devtools::install()
library(scImmuneCo)
c <- do_dep(sjs_object,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
c <- do_dep(sjs_object,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
devtools::document()
devtools::install()
library(scImmuneCo)
c <- do_dep(sjs_object,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
View(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
%>%
?%>%
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
?mutate
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
?summarise
?group_by
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
?n
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
View(c)
View(c)
colnames(c)[2] <- 'avg_log2FC'
colnames(c)[3] <- 'p_val'
colnames(c)[4] <- 'cluster'
colnames(c)[1] <- 'gene'
scRNAtoolVis::jjVolcano(diffData = select_results, topGeneN = 0, tile.col = beautiful_colors,
back.col= 'white') + ggplot2::xlab(''
) + ggplot2::ylab('') + ggplot2::ggtitle(a)
scRNAtoolVis::jjVolcano(diffData = c, topGeneN = 0, tile.col = beautiful_colors,
back.col= 'white') + ggplot2::xlab(''
) + ggplot2::ylab('') + ggplot2::ggtitle(a)
c$p_val_adj <- p.adjust(c$p_val, method = 'fdr')
scRNAtoolVis::jjVolcano(diffData = c, topGeneN = 0, tile.col = beautiful_colors,
back.col= 'white') + ggplot2::xlab(''
) + ggplot2::ylab('') + ggplot2::ggtitle(a)
beautiful_colors <- c(
'Mono' = "#E63946",  # Vibrant red
'DC' = "#F4A261",  # Warm orange
'CD8T' = "#2A9D8F",  # Teal green
'CD4T' = "#264653",  # Dark blue-green
'NK' = "#E9C46A",  # Golden yellow
'other_T' = "#6A4C93",  # Rich purple
'B' = "#3A86FF"   # Bright blue
)
scRNAtoolVis::jjVolcano(diffData = c, topGeneN = 0, tile.col = beautiful_colors,
back.col= 'white') + ggplot2::xlab(''
) + ggplot2::ylab('') + ggplot2::ggtitle(a)
c$avg_log2FC <- as.numeric(c$avg_log2FC)
scRNAtoolVis::jjVolcano(diffData = c, topGeneN = 0, tile.col = beautiful_colors,
back.col= 'white') + ggplot2::xlab(''
) + ggplot2::ylab('') + ggplot2::ggtitle(a)
View(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
View(c)
c <- do_dep(sjs_object,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
View(c)
draw_volcano(c)
View(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
a <- gsva_cell_type(sjs_object, cell = 'CD4 T', sample_column = 'batch')
b <- compare_condition(sjs_object, gsva = a,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
c <- do_dep(sjs_object,
sample_column = 'batch',
condition_column = 'condition',
condition1 = 'SjS',
condition2 = 'HC')
View(c)
?split
?stack
?clusterProfiler
devtools::document()
devtools::document()
devtools::install()
library(scImmuneCo)
gene_enrichment_scimmuneco(gene_list = c('CD4', 'CD8A', 'CD8B', 'CD3D', 'CD3E', 'CD3G', 'CD2', 'CD28', 'ICOS', 'PDCD1', 'CTLA4'))
A <- gene_enrichment_scimmuneco(gene_list = c('CD4', 'CD8A', 'CD8B', 'CD3D', 'CD3E', 'CD3G', 'CD2', 'CD28', 'ICOS', 'PDCD1', 'CTLA4'))
View(A)
all_module <- read.csv('../../03.annotation_module/all_module.csv', row.names = 1)
View(all_module)
all_module <- read.csv('../../03.annotation_module/medium_merged_module.csv', row.names = 1)
View(all_module)
View(all_module$merge_module)
View(as.data.frame(table(all_module$merge_module)))
View(as.data.frame(table(all_module$merge_module)))
View(c)
A <- gene_enrichment_scimmuneco(gene_list = c('IFI44', 'IRF7', 'IFITM2'))
View(A)
#' compare between two conditions
#'
#' @param gene_list INPUT GENE LIST
#' @return Differentially expressed modules
#' @export
gene_enrichment_scimmuneco <- function(gene_list){
gmt <- module_info
gmt <- dplyr::select(gmt, c(5,1))
colnames(gmt) <- c('term', 'gene')  # Rename columns to "term" and "gene"
gmt <- split(gmt$gene, gmt$term, drop = TRUE)
gmt_fixed <- utils::stack(gmt)  # Converts list to 2-column dataframe (ind, values)
colnames(gmt_fixed) <- c("gene", "term")  # Rename columns to "term" and "gene"
gmt_fixed <- gmt_fixed[, c("term", "gene")]  # Reorder columns
gene_res <- clusterProfiler::enricher(gene = gene_list , TERM2GENE = gmt_fixed, pAdjustMethod = 'none', pvalueCutoff = 0.05)
return(gene_res)
}
devtools::document()
devtools::install()
library(scImmuneCo)
A <- gene_enrichment_scimmuneco(gene_list = c('IFI44', 'IRF7', 'IFITM2'))
DotPlot(A)
library(clusterProfiler)
DotPlot(A)
dotplot(A)
View(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
?ifelse
?mutate
devtools::document()
devtools::install()
dotplot(A)
draw_volcano(c)
View(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c)
draw_volcano(c, p_cutoff = 0.05)
draw_volcano(c, p_cutoff = 0.01)
draw_volcano(c, p_cutoff = 0.01, logFC_cutoff = 1)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c, p_cutoff = 0.01, logFC_cutoff = 1)
devtools::document()
devtools::install()
library(scImmuneCo)
draw_volcano(c, p_cutoff = 0.01, logFC_cutoff = 1)
draw_volcano(c, p_cutoff = 0.01, logFC_cutoff = 0.5)
devtools::document()
devtools::install()
library(scImmuneCo)
library(Seurat)
sjs_object <- readRDS('F:/coexpression_project/01.cscore/SjS/rds/SjS.rds')
sjs_object@meta.data
